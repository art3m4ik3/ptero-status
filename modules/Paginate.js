"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Paginate=void 0;const discord_js_1=require("discord.js"),paginationButton_1=require("../buttons/paginationButton");class Paginate{constructor(e){this.bot=e,this.updateNextBack=async(e,t,a,o)=>0===o?e(a):"next"===t?await e(a+1<=o-1?a+1:0):"back"===t?await e(a-1>=0?a-1:o-1):void 0,this.paginate=async(e,t,a=[],o=(async()=>{}),n=(()=>!1),s=!1,i=12e4,c=(()=>!1))=>{const p={value:0},r=e.member?.user.id,u=(0,paginationButton_1.paginationButtonRow)(this.bot,s),d=async e=>{await e.editReply({embeds:[t[p.value].setFooter({text:this.bot.t("pagination.page",{page:p.value+1,pages:t.length})})],components:[...a,u]})},l=(await e.editReply({embeds:[t[p.value].setFooter({text:this.bot.t("pagination.page",{page:p.value+1,pages:t.length})})],components:[...a,u]})).createMessageComponentCollector({filter:async e=>r===e.member?.user.id&&(n(e)||"back"===e.customId||"next"===e.customId||"refresh"===e.customId),time:i,componentType:discord_js_1.ComponentType.Button}),g=async(a=!0)=>{u.components.forEach((e=>e.setDisabled(!0)));const o={components:[u]};a&&t.length>0&&(o.embeds=[t[p.value].setFooter({text:this.bot.t("pagination.page",{page:p.value+1,pages:t.length})})]),await e.editReply(o).catch((()=>{}))};l.on("collect",(async e=>{switch(c(e)||await e.deferUpdate(),await o(p,e,{refreshEmbed:d,onEnd:g,row:u}),e.customId){case"back":p.value=p.value>0?--p.value:t.length-1;break;case"next":p.value=p.value+1<t.length?++p.value:0}"back"!==e.customId&&"next"!==e.customId||await d(e),l.resetTimer()})),l.on("end",g)}}}exports.Paginate=Paginate;