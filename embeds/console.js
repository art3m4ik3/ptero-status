"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeConsoleEmbed=exports.timeLeft=exports.logsUnderLimit=void 0;const status_1=require("./status"),logsUnderLimit=(e,t=10)=>{let o="",r=t;do{o=e.slice(e.length-r,e.length).join("\n"),r--}while(o.length>4090);return o};exports.logsUnderLimit=logsUnderLimit;const embedColorByServerState=e=>{switch(e){case"starting":return"Yellow";case"offline":return"Red";case"running":return"Green";default:return"Grey"}},timeLeft=e=>Math.ceil((e._idleStart+e._idleTimeout)/1e3-process.uptime());exports.timeLeft=timeLeft;const makeConsoleEmbed=(e,t,o,r,s={})=>{const{values:i,timeout:n,title:l,limit:m}=s;return e.embed({title:l??e.e("console",{name:o.name}),url:`${e.config.pteroHost}/server/${o.identifier}`,description:"```ansi\n"+(0,exports.logsUnderLimit)(r,m)+"\n```",fields:i?(0,status_1.consoleStatusFields)(e,i):void 0,footer:n?{text:`${(0,exports.timeLeft)(n)}s`}:void 0},{embedColor:i?embedColorByServerState(i.state):t.embedColor})};exports.makeConsoleEmbed=makeConsoleEmbed;